<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>React Without JSX</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700;900&display=swap" rel="stylesheet">

    <style>
      :root {
        --bg-1: #f6efff;
        --bg-2: #efe1ff;
        --accent: #6a3ecf;
      }

      html, body {
        height: 100%;
        margin: 0;
      }

      body {
        display: flex;
        align-items: flex-start;
        justify-content: center;
        position: relative;
        font-family: 'Poppins', Arial, Helvetica, sans-serif !important;
        color: #2a1b45;
      }

      body::before {
        content: '';
        position: fixed;
        inset: 0;
        z-index: -1;
        background: linear-gradient(180deg, var(--bg-1), var(--bg-2));
        background-attachment: fixed;
      }

      #root {
        display: flex;
        align-items: flex-start;
        justify-content: center;
        min-height: 100vh;
        width: 100%;
        position: relative;
        z-index: 1;
      }

      button, input, select {
        border-radius: 14px !important;
        font-family: inherit !important;
        transition: all 0.2s ease;
      }

      button {
        cursor: pointer;
        border: none;
        padding: 8px 14px;
      }

      button:hover {
        opacity: 0.9;
        transform: translateY(-1px);
      }

      button:active {
        transform: translateY(0);
        opacity: 0.95;
      }

      input[type="checkbox"], input[type="radio"] {
        accent-color: var(--accent);
        border-radius: 6px;
        transform: scale(1.1);
      }

      button:focus, input:focus {
        outline: none;
      }
    </style>
  </head>

  <body>
    <div id="root"></div>

    <!-- Khi build xong, script bundle s·∫Ω n·∫±m trong /dist -->
<script type="module" src="/src/main.tsx"></script>

    <!-- Helper: when opened via file://, try to open built /dist/index.html if present, otherwise show instructions -->
    <script>
      (function(){
        try {
          if (location.protocol === 'file:') {
            // Try to fetch built dist/index.html (works when project was built)
            fetch('./dist/index.html').then(function(res) {
              if (res && res.ok) {
                // redirect to the built index which references compiled assets in ./dist/assets/
                location.replace('./dist/index.html')
              } else {
                showHelp()
              }
            }).catch(function(){ showHelp() })
          }
        } catch (e) { /* ignore */ }

        function showHelp(){
          // Insert a static fallback UI so opening index.html directly shows a similar layout to the dev app.
          const root = document.getElementById('root') || document.body

          const fallback = document.createElement('div')
          fallback.style.width = '100%'
          fallback.style.maxWidth = '1100px'
          fallback.innerHTML = `
            <div style="font-size:96px;color:var(--accent);font-weight:900;letter-spacing:2px;text-transform:uppercase;margin-bottom:22px;line-height:1">REACT WITHOUT JSX</div>

            <div style="display:flex;gap:28px;align-items:flex-start">
              <div style="width:300px;min-width:260px;flex:0 0 300px">
                <div style="background:white;border-radius:24px;padding:18px;margin-bottom:18px;box-shadow:0 20px 50px rgba(120,80,160,0.09);text-align:center">
                  <div style="font-weight:900;color:#6a3ecf;margin-bottom:6px">COUNTER POP-UP</div>
                  <div style="font-size:28px;font-weight:700;color:#6a3ecf" id="fallback-counter-value">0</div>
                  <div style="margin-top:12px;display:flex;gap:8px;justify-content:center;align-items:center">
                    <button id="fallback-counter-dec" style="width:36px;height:36px;border-radius:9999;border:1px solid rgba(100,60,140,0.08);background:#f7efff">-</button>
                    <button id="fallback-counter-reset" style="padding:6px 10px;border-radius:12px;background:#ffd9e6;color:#6a1d5f;border:none">RESET</button>
                    <button id="fallback-counter-inc" style="width:36px;height:36px;border-radius:9999;background:var(--accent);color:white;border:none">+</button>
                  </div>
                </div>

                <div style="background:white;border-radius:20px;padding:22px;color:#6a2f84;min-height:120px;box-shadow:0 12px 30px rgba(120,80,160,0.06)">
                  <div style="font-size:18px;font-weight:900;margin-bottom:8px;color:#6a2f84">Task list</div>
                  <div style="font-weight:800;margin-bottom:6px">Completed / Total: <span id="fallback-completed">0</span> / <span id="fallback-total">0</span></div>
                  <ul id="fallback-todo-list" style="padding-left:18px;margin:0;color:#5b2b75"></ul>
                </div>
              </div>

              <div style="flex:1 1 520px;max-width:520px;background:white;border-radius:24px;padding:18px;box-shadow:0 20px 50px rgba(120,80,160,0.09)">
                <div style="text-align:center;margin-bottom:12px;font-size:28px;font-weight:900;color:#e05a77">TODO LIST</div>

                <div style="display:flex;gap:8px;justify-content:center;margin-bottom:12px">
                  <button id="filter-all" style="padding:8px 12px;border-radius:9999;background:#cdb5ff;border:none;color:#4b1d92;font-weight:800">All</button>
                  <button id="filter-active" style="padding:8px 12px;border-radius:9999;background:#ede2ff;border:none;color:#4b1d92;font-weight:800">In Progress</button>
                  <button id="filter-completed" style="padding:8px 12px;border-radius:9999;background:#ede2ff;border:none;color:#4b1d92;font-weight:800">Completed</button>
                </div>

                <div style="display:flex;gap:8px;margin-bottom:16px;padding:0 12px">
                  <textarea id="fallback-todo-input" placeholder="Add a new task... (one per line)" style="flex:1;padding:12px;border-radius:12px;border:2px solid #f0e0ff;height:120px;font-family:monospace;resize:none"></textarea>
                  <button id="fallback-todo-add" style="padding:12px 16px;border-radius:12px;background:#6a3ecf;color:white;border:none;align-self:flex-start">Add</button>
                </div>

                <div style="border-top:1px solid rgba(120,80,160,0.06);padding-top:12px;padding-left:12px;padding-right:12px">
                  <div style="display:flex;justify-content:space-between;font-weight:800;color:#5b2b75;padding-bottom:8px"><div>Task</div><div>Done</div></div>
                  <ul id="fallback-todo-list-rows" style="list-style:none;padding:0;margin:0;color:#5b2b75"></ul>
                </div>
              </div>

              <div style="width:320px;min-width:280px;flex:0 0 320px">
                <div style="background:white;border-radius:20px;padding:18px 22px;box-shadow:0 20px 50px rgba(120,80,160,0.09);position:relative;z-index:2">
                  <h3 style="color:#3b0b5f;margin-bottom:12px;font-size:16px;font-weight:900">Dashboard</h3>

                  <div style="display:flex;gap:8px;margin-bottom:12px">
                    <button id="fallback-chart-bar" style="padding:8px 12px;border-radius:9999;border:none;font-weight:700;cursor:pointer;background:#cdb5ff;color:#4b1d92">Bar</button>
                    <button id="fallback-chart-line" style="padding:8px 12px;border-radius:9999;border:none;font-weight:700;cursor:pointer;background:#ede2ff;color:#4b1d92">Line</button>
                    <button id="fallback-chart-pie" style="padding:8px 12px;border-radius:9999;border:none;font-weight:700;cursor:pointer;background:#ede2ff;color:#4b1d92">Pie</button>
                  </div>

                  <div style="display:flex;justify-content:center">
                    <canvas id="fallback-chart" width="300" height="200" style="display:block;border-radius:12px;border:1px solid rgba(0,0,0,0.06);background:white"></canvas>
                  </div>

                  <div id="fallback-chart-caption" style="margin-top:12px;font-size:13px;color:#5c3d9e;text-align:center">0 / 0 (0% in progress)</div>
                </div>
              </div>
            </div>
          `

          // Clear any existing content and append the fallback
          if (root !== document.body) root.innerHTML = ''
          root.appendChild(fallback)

          // Small interactive behavior for the fallback UI
          try {
            const cntEl = document.getElementById('fallback-counter-value')
            const inc = document.getElementById('fallback-counter-inc')
            const dec = document.getElementById('fallback-counter-dec')
            const resetBtn = document.getElementById('fallback-counter-reset')
            var counter = 0
            function renderCounter(){ if(cntEl) cntEl.textContent = String(counter) }
            if(inc) inc.addEventListener('click', function(){ counter++; renderCounter() })
            if(dec) dec.addEventListener('click', function(){ counter = Math.max(0, counter-1); renderCounter() })
            if(resetBtn) resetBtn.addEventListener('click', function(){ counter = 0; renderCounter() })

            // Todos state + persistence
            var todos = []
            try { var saved = localStorage.getItem('fallbackTodos'); if(saved) todos = JSON.parse(saved) } catch(e){}
            var filter = 'all' // all | active | completed

            var todoList = document.getElementById('fallback-todo-list')
            var todoRows = document.getElementById('fallback-todo-list-rows')
            var todoInput = document.getElementById('fallback-todo-input')
            var todoAdd = document.getElementById('fallback-todo-add')
            var totalEl = document.getElementById('fallback-total')
            var completedEl = document.getElementById('fallback-completed')
            var chartCaption = document.getElementById('fallback-chart-caption')
            var btnBar = document.getElementById('fallback-chart-bar')
            var btnLine = document.getElementById('fallback-chart-line')
            var btnPie = document.getElementById('fallback-chart-pie')
            var chartType = 'bar'

            var filterAll = document.getElementById('filter-all')
            var filterActive = document.getElementById('filter-active')
            var filterCompleted = document.getElementById('filter-completed')

            function saveTodos(){ try{ localStorage.setItem('fallbackTodos', JSON.stringify(todos)) }catch(e){} }

            function setChartType(t){ chartType = t; if(btnBar) btnBar.style.background = (t==='bar'? '#cdb5ff' : '#ede2ff'); if(btnLine) btnLine.style.background = (t==='line'? '#cdb5ff' : '#ede2ff'); if(btnPie) btnPie.style.background = (t==='pie'? '#cdb5ff' : '#ede2ff'); renderTodos() }
            if(btnBar) btnBar.addEventListener('click', function(){ setChartType('bar') })
            if(btnLine) btnLine.addEventListener('click', function(){ setChartType('line') })
            if(btnPie) btnPie.addEventListener('click', function(){ setChartType('pie') })

            if(filterAll) filterAll.addEventListener('click', function(){ filter='all'; setFilterButtons(); renderTodos() })
            if(filterActive) filterActive.addEventListener('click', function(){ filter='active'; setFilterButtons(); renderTodos() })
            if(filterCompleted) filterCompleted.addEventListener('click', function(){ filter='completed'; setFilterButtons(); renderTodos() })

            function setFilterButtons(){ if(filterAll) filterAll.style.background = (filter==='all'?'#cdb5ff':'#ede2ff'); if(filterActive) filterActive.style.background = (filter==='active'?'#cdb5ff':'#ede2ff'); if(filterCompleted) filterCompleted.style.background = (filter==='completed'?'#cdb5ff':'#ede2ff') }

            function renderTodos(){
              if(!todoRows) return
              todoRows.innerHTML = ''
              var visible = todos.filter(function(t){ if(filter==='all') return true; if(filter==='active') return !t.done; return t.done })
              visible.forEach(function(t){
                var li = document.createElement('li')
                li.style.display = 'flex'
                li.style.justifyContent = 'space-between'
                li.style.alignItems = 'center'
                li.style.padding = '10px 6px'
                li.style.borderBottom = '1px solid rgba(120,80,160,0.04)'

                var left = document.createElement('div')
                left.style.display = 'flex'
                left.style.alignItems = 'center'
                left.style.gap = '12px'

                var span = document.createElement('span')
                span.textContent = t.task
                span.style.color = t.done ? '#9b8aa8' : '#3b0b5f'
                if(t.done) span.style.textDecoration = 'line-through'

                var cb = document.createElement('input')
                cb.type = 'checkbox'
                cb.checked = !!t.done
                cb.addEventListener('change', function(){ t.done = cb.checked; saveTodos(); updateCounts(); renderTodos() })

                left.appendChild(span)

                var right = document.createElement('div')
                right.style.display = 'flex'
                right.style.alignItems = 'center'
                right.style.gap = '8px'

                var del = document.createElement('button')
                del.innerHTML = 'üóëÔ∏è'
                del.style.border = 'none'
                del.style.background = 'transparent'
                del.style.cursor = 'pointer'
                del.addEventListener('click', function(){ todos = todos.filter(function(x){ return x.id !== t.id }); saveTodos(); renderTodos(); updateCounts() })

                right.appendChild(cb)
                right.appendChild(del)

                li.appendChild(left)
                li.appendChild(right)
                todoRows.appendChild(li)
              })
              updateCounts()
            }

            function drawChart(total, completed){
              try{
                var canvas = document.getElementById('fallback-chart')
                if(!(canvas instanceof HTMLCanvasElement)) return
                var ctx = canvas.getContext('2d')
                if(!ctx) return
                var w = canvas.width
                var h = canvas.height
                ctx.clearRect(0,0,w,h)
                ctx.fillStyle = '#fff'
                ctx.fillRect(0,0,w,h)
                var padding = 24
                var bw = 80
                var max = Math.max(total,1)
                if(chartType === 'bar'){
                  var compH = Math.round((completed/max) * (h - padding*2))
                  var actH = Math.round(((total-completed)/max) * (h - padding*2))
                  ctx.fillStyle = '#cdb5ff'
                  ctx.fillRect(padding, h - padding - compH, bw, compH)
                  ctx.fillStyle = '#9cd6ff'
                  ctx.fillRect(padding + bw + 20, h - padding - actH, bw, actH)
                } else if(chartType === 'pie'){
                  var totalVal = Math.max(total,1)
                  var start = -Math.PI/2
                  var compAngle = (completed/totalVal) * Math.PI*2
                  ctx.beginPath(); ctx.moveTo(w/2,h/2); ctx.arc(w/2,h/2, Math.min(w,h)/3, start, start+compAngle); ctx.closePath(); ctx.fillStyle='#cdb5ff'; ctx.fill();
                  ctx.beginPath(); ctx.moveTo(w/2,h/2); ctx.arc(w/2,h/2, Math.min(w,h)/3, start+compAngle, start+Math.PI*2); ctx.closePath(); ctx.fillStyle='#9cd6ff'; ctx.fill();
                } else {
                  var x1 = padding; var y1 = h - padding - Math.round((completed/max)*(h - padding*2))
                  var x2 = w - padding; var y2 = h - padding - Math.round(((total-completed)/max)*(h - padding*2))
                  ctx.beginPath(); ctx.moveTo(x1,y1); ctx.lineTo(x2,y2); ctx.strokeStyle='#7a43ff'; ctx.lineWidth=2; ctx.stroke();
                  ctx.fillStyle='#7a43ff'; ctx.beginPath(); ctx.arc(x1,y1,4,0,Math.PI*2); ctx.fill(); ctx.beginPath(); ctx.arc(x2,y2,4,0,Math.PI*2); ctx.fill();
                }
              }catch(e){}
            }

            function updateCounts(){
              var total = todos.length
              var completed = todos.filter(function(t){ return t.done }).length
              if(totalEl) totalEl.textContent = String(total)
              if(completedEl) completedEl.textContent = String(completed)
              drawChart(total, completed)
              var inProgress = total - completed
              var percent = total ? Math.round((inProgress/total)*100) : 0
              if(chartCaption) chartCaption.textContent = inProgress + ' / ' + total + ' (' + percent + '% in progress)'
            }

            function escapeHtml(str){ return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;') }

            function renderFromStorage(){ renderTodos(); setFilterButtons(); renderCounter(); setChartType(chartType) }

            // wire add
            if(todoAdd) todoAdd.addEventListener('click', function(){
              var val = todoInput && (todoInput.value || todoInput.textContent) ? (todoInput.value || todoInput.textContent).trim() : ''
              if(!val) return
              var lines = val.split('\n').map(function(s){ return s.trim() }).filter(Boolean)
              lines.forEach(function(text){ todos.push({ id: Date.now() + Math.random(), task: escapeHtml(text), done: false }) })
              if(todoInput && 'value' in todoInput) todoInput.value = ''
              saveTodos(); renderTodos();
            })

            // Enter to add (Shift+Enter inserts newline)
            if(todoInput) todoInput.addEventListener('keydown', function(e){
              if(e.key === 'Enter'){
                if(e.shiftKey) return // allow newline with Shift+Enter
                e.preventDefault()
                if(todoAdd) todoAdd.click()
              }
            })

            // initial render
            renderFromStorage()
          } catch(e) { /* ignore fallback errors */ }
        }
      })()
    </script>
  </body>
</html>
